# Быстрый старт

Мы собрали для вас готовые образы и залили их в Docker Hub, для того, чтобы не зависеть от платформы и локальной сборки образов и быстро начать работу

Этот раздел охватывает каким образом происходит запуск решения:
1. [Для внутреннего тестироваия на 400 КТ](#1-быстрый-старт-внутреннего-тестирования-на-400-кт-из-заранее-подготовленного-образа)
2. [Для развертывания сервиса](#2-быстрый-старт-сервисов-из-заранее-подготовленных-образов)

Видео инструкции представлены на [Яндекс.Диске](https://disk.yandex.ru/d/nq0x0-Ivx93VJw)

# 1. Быстрый старт внутреннего тестирования на 400 КТ из заранее подготовленного образа

Чтобы запустить инференс для папки с архивами, необходимо:

1. Указать системную переменную `YOUR_INPUT_FOLDER_WITH_ZIPS` на абсолютный путь к папке с архивами:

```bash
export YOUR_INPUT_FOLDER_WITH_ZIPS="/home/borntowarn/projects/chest-diseases/input"
```
или для **Windows** в Git Bash:
```bash
export YOUR_INPUT_FOLDER_WITH_ZIPS="C:\Users\borntowarn\Downloads\Yandex.Disk.Files"
ИЛИ
export YOUR_INPUT_FOLDER_WITH_ZIPS="C:/Users/borntowarn/Downloads/Yandex.Disk.Files"
```

Ваша папка должна иметь структуру вида:
```
YOUR_INPUT_FOLDER_WITH_ZIPS/
├── study_id_1.zip
├── study_id_2.zip
├── ...
├── final_archive.zip
```

2. Запустить скрипт:

**Linux**
```bash
bash ./inference.remote.sh
```
**Windows**
```bash
./inference.remote.sh
```

Это запустит скачивание контейнера (~6ГБ) из Docker Hub и автоматически запустит внутренний скрипт `inference.py` по примонтированной папке, которая указана в `YOUR_INPUT_FOLDER_WITH_ZIPS`.


Он пробежит по всем элементам папки `YOUR_INPUT_FOLDER_WITH_ZIPS`, выполнит для них инференс и сохранит в папку `output` 2 файла:
- `output.xlsx` - результаты инференса в формате Excel
- `warnings_and_errors.txt` - ошибки чтения файлов и предупреждения в формате txt.


# 2. Быстрый старт сервисов из заранее подготовленных образов

Эти образы содержат в себе все необходимые модели и скрипты для запуска сервисов.
ℹ️ При первом запуске загрузка образов может занять время, необходимое для загрузки образов. Контейнеры весят в сумме около 20Гб.

Чтобы запустить сервисы для развертывания решения, необходимо:

1. Запустить `start.remote.sh` для запуска сервисов из Docker Hub
```bash
sh ./start.remote.sh
```

2. Откройте UI интерфейс: `http://localhost:7860` (ℹ️ не забудьте прокинуть порт на хост машину, если вы работаете через SSH)


3. Чтобы остановить сервисы, необходимо запустить `stop.remote.sh`:
```bash
sh ./stop.remote.sh
```

Открытые порты:
- Triton: `8000` (HTTP), `8001` (gRPC), `8002` (Metrics)
- RabbitMQ: `5672` (AMQP), `15672` (Management UI, логин/пароль: `guest/guest`)
- Frontend (Gradio): `7860`

ℹ️ Если порты заняты, остановите конфликтующие сервисы или измените порт-маппинг в compose.