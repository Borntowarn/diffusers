# Запуск стека для развертывания сервиса

Этот раздел охватывает каким образом разворачиваются сервисы для запуска решения.

### 1. Быстрый старт из заранее подготовленных образов

Мы собрали для вас готовые образы и залили их в Docker Hub, для того, чтобы не зависеть от платформы и локальной сборки образов и быстро начать работу.
Чтобы запустить сервисы для развертывания решения, необходимо:

1. Запустить `start.remote.sh` для запуска сервисов из Docker Hub
```bash
sh ./start.remote.sh
```

Docker автоматически начнет скачивать образы с заранее подготовленными моделями и скриптами внутри, для того, чтобы не тратить время на сборку образов.

ℹ️ При первом запуске загрузка образов может занять значительное время необходимое для загрузки образов.

2. Чтобы остановить сервисы, необходимо запустить `stop.remote.sh`:
```bash
sh ./stop.remote.sh
```

### 2. Локальная сборка образов и запуск сервисов

Для того, чтобы запустить сервисы локально, необходимо
1. Подготовить репозиторий с моделями и весами для запуска TritonServer [гайду](./models.md) (пункт 2).

⚠️ Структура `model_repository_running` должна совпадать с образцом ниже, иначе Triton не поднимет модели.

Финальная структура должна быть следующей:

```
...
├── convertation
├── model_repository_running
│   ├── binary_onnx
│   │   ├── 1
│   │   │   └── model.onnx
│   │   └── config.pbtxt
│   ├── bpr_model
│   │   ├── 1
│   │   │   ├── bpreg
│   │   │   ├── model.py
│   │   │   ├── requirements.txt
│   │   │   └── weights
│   │   └── config.pbtxt
│   ├── multilabel_onnx
│   │   ├── 1
│   │   │   └── model.onnx
│   │   └── config.pbtxt
│   └── vit_onnx
│       ├── 1
│       │   └── model.onnx
│       └── config.pbtxt
├── services
...
```

2. Запустить `start.local.sh` для локальной сборки образов и запуска сервисов

Это запустит процесс подгрузки образа RabbitMQ, а так же сборку сервисов TritonServer, Adapter и Frontend.


3. Чтобы остановить сервисы, необходимо запустить `stop.local.sh`:
```bash
sh ./stop.local.sh
```